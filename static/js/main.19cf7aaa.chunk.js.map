{"version":3,"sources":["WeatherRadial.tsx","App.tsx","index.tsx"],"names":["ETLWeatherData","wd","name","NAME","tavg","TAVG","tmax","TMAX","tmin","TMIN","prcp","PRCP","date","dayjs","DATE","toDate","Circle","_React$Component","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","apply","arguments","inherits","createClass","key","value","_componentDidMount","asyncToGenerator","regenerator_default","a","mark","_callee2","wrap","_context2","prev","next","forEach","_ref2","_callee","_ref","_ref3","label","csvFile","_context","slicedToArray","t0","CircleRender","t1","d3","t2","t3","sent","map","abrupt","stop","_x","react_default","createElement","id","React","Component","city","data","svg","append","attr","originX","originY","barOriginX","Math","sin","barOriginY","cos","allTemps","reduce","p","n","toConsumableArray","concat","dayScale","domain","range","tempScaleInvert","monthScale","text","toUpperCase","monthLabels","selectAll","enter","classed","d","i","tempScale","ticks","style","remove","formatNumber","xAxis","tickFormat","call","select","insert","colors","rainScale","rainDrops","barWidth","rotateTween","el","transition","duration","attrTween","toString","App","WeatherRadial_Circle","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"6TAaMA,EAAiB,SAACC,GAAD,MAA2B,CAChDC,KAAMD,EAAGE,KACTC,MAAOH,EAAGI,KACVC,MAAOL,EAAGM,KACVC,MAAOP,EAAGQ,KACVC,MAAOT,EAAGU,KACVC,KAAMC,IAAMZ,EAAGa,MAAMC,WAGVC,EAAb,SAAAC,GAAA,SAAAD,IAAA,OAAAE,OAAAC,EAAA,EAAAD,CAAAE,KAAAJ,GAAAE,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAF,GAAAO,MAAAH,KAAAI,YAAA,OAAAN,OAAAO,EAAA,EAAAP,CAAAF,EAAAC,GAAAC,OAAAQ,EAAA,EAAAR,CAAAF,EAAA,EAAAW,IAAA,oBAAAC,MAAA,eAAAC,EAAAX,OAAAY,EAAA,EAAAZ,CAAAa,EAAAC,EAAAC,KAAA,SAAAC,IAAA,OAAAH,EAAAC,EAAAG,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAEI,CACE,CAAC,gBAAiB,wBAClB,CAAC,SAAU,oBACX,CAAC,cAAe,yBAChB,CAAC,UAAW,qBACZ,CAAC,gBAAiB,iBAClB,CAAC,YAAa,wBACdC,QAPF,eAAAC,EAAAtB,OAAAY,EAAA,EAAAZ,CAAAa,EAAAC,EAAAC,KAOU,SAAAQ,EAAAC,GAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAAd,EAAAC,EAAAG,KAAA,SAAAW,GAAA,cAAAA,EAAAT,KAAAS,EAAAR,MAAA,cAAAK,EAAAzB,OAAA6B,EAAA,EAAA7B,CAAAwB,EAAA,GAAQE,EAARD,EAAA,GAAeE,EAAfF,EAAA,GAAAG,EAAAE,GACRC,EADQH,EAAAI,GACKN,EADLE,EAAAR,KAAA,EACmBa,IAAON,GAD1B,cAAAC,EAAAM,GACwCpD,EADxC8C,EAAAO,GAAAP,EAAAQ,KACoCC,IADpCT,EAAAM,IAAAN,EAAAU,OAAA,YAAAV,EAAAE,IAAAF,EAAAI,GAAAJ,EAAAO,KAAA,wBAAAP,EAAAW,SAAAhB,EAAArB,SAPV,gBAAAsC,GAAA,OAAAlB,EAAAjB,MAAAH,KAAAI,YAAA,IAFJ,wBAAAY,EAAAqB,SAAAvB,EAAAd,SAAA,yBAAAS,EAAAN,MAAAH,KAAAI,YAAA,KAAAG,IAAA,SAAAC,MAAA,WAcI,OAAO+B,EAAA3B,EAAA4B,cAAA,OAAKC,GAAG,wBAdnB7C,EAAA,CAA4B8C,IAAMC,WAkBlC,SAASd,EAAae,EAAcC,GAClC,IAAIC,EAAMf,IAAU,oBAAoBgB,OAAO,OAE/CD,EACGE,KAAK,UAAW,iBAChBA,KAAK,QAAS,KACdA,KAAK,SAAU,KAElB,IAAIC,EAAU,IACVC,EAAU,IAIVC,EAAaF,EAHO,IAGuBG,KAAKC,IAAI,GACpDC,EAAaJ,EAJO,IAIuBE,KAAKG,IAAI,GAElDC,EAAWX,EAAKY,OACpB,SAACC,EAAGC,GAAJ,OAAA7D,OAAA8D,EAAA,EAAA9D,CAAc4D,GAAdG,OAAA,CAAiBF,EAAEvE,KAAMuE,EAAEzE,QAC3B,IAKE4E,GAFS/B,IAAUyB,GAERzB,MAEZgC,OAAO,CAAC,EAAG,MACXC,MAAM,CAAC,EAAG,OAETC,EAAkBlC,MAEnBgC,OAAO,EAAE,GAAI,KACbC,MAAM,CArBe,IAqBK,IAEvBE,EAAanC,MAEhBgC,OAAO,CAAC,EAAG,KACXC,MAAM,CAAC,EAAG,MAiBblB,EACGC,OAAO,QACPoB,KAAKvB,EAAKwB,eACVpB,KAAK,YAHR,aAAAa,OAGkCZ,EAHlC,KAAAY,OAG6CX,EAH7C,MAIGF,KAAK,cAAe,UACpBA,KAAK,YAAa,UAClBA,KAAK,OAAQ,WACbA,KAAK,IAAK,WAEb,IAAMqB,EAAcvB,EACjBwB,UAAU,iBACVzB,KA1BY,CACb,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,QAeC0B,QACAxB,OAAO,KACPyB,QAAQ,eAAe,GAE1BH,EACGtB,OAAO,QACPC,KAAK,SAAU,SACfA,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,KAAM,IAEdqB,EACGrB,KACC,YACA,SAACyB,EAAGC,GAAJ,gBAAAb,OACYK,EACRQ,GAFJ,KAAAb,OAGOZ,EAHP,KAAAY,OAGkBX,EAHlB,gBAAAW,OAGwCZ,EAHxC,KAAAY,OAGmDP,EAAa,GAHhE,OAKDP,OAAO,QACPC,KAAK,OAAQ,SACbA,KAAK,IAAK,IACVA,KAAK,IAAK,IACVmB,KAAK,SAASM,GACb,OAAOA,EAAEL,gBAGb,IAAIO,EAAY5C,MAEbgC,OAAO,EAAE,GAAI,KACbC,MAAM,CAAC,EArFc,MAuFVlB,EACXwB,UAAU,iBACVzB,KAAK8B,EAAUC,MAAM,IACrBL,QACAxB,OAAO,UACPyB,QAAQ,gBAAgB,GACxBxB,KAAK,IAAK,SAASyB,GAClB,OAAOE,EAAUF,KAElBI,MAAM,OAAQ,QACd7B,KAAK,KAAME,GACXF,KAAK,KAAMC,GACX4B,MAAM,SAAU,SAChBA,MAAM,mBAAoB,OAC1BA,MAAM,eAAgB,QAEzB/B,EAAIwB,UAAU,gCAAgCQ,SAE9C,IAAIC,EAAehD,IAAU,KACzBiD,EAAQjD,IACAkC,GACTW,MAAM,GACNK,WAAW,SAAAR,GAAC,OAAIM,EAAaN,GAAK,WAErC3B,EACGC,OAAO,KACPC,KAAK,QAAS,UACdA,KAAK,YAHR,aAAAa,OAGkCV,EAHlC,KAAAU,OAGgDP,EAHhD,MAIG4B,KAAKF,GAERlC,EAAIqC,OAAO,WAAWL,SACtBhC,EAAIwB,UAAU,cAAcQ,SAC5BhC,EACGwB,UAAU,SACVc,OAAO,OAAQ,gBACfpC,KAAK,QAAS,MACdA,KAAK,SAAU,MACfA,KAAK,OAAQ,QACbA,KAAK,YAAa,qBAErBF,EACGwB,UAAU,cACVO,MAAM,cAAe,UACrB7B,KAAK,YAAa,mBAClB6B,MAAM,gBAAiB,IAE1B/B,EAAIwB,UAAU,uBAAuBQ,SAGrC,IAAMO,EAAStD,IAAmBA,KAAwBgC,OAAO,CAAC,GAAI,IAEhEuB,EAAYvD,MAEfiC,MAAM,CAAC,EAAG,MACVD,OAAO,CAAC,EAAG,MAERwB,EAAYzC,EACfwB,UAAU,SACVzB,KAAKA,GACL0B,QACAxB,OAAO,UACPC,KACC,KACA,SAAAyB,GAAC,OACEE,EAAUF,EAAEvF,MAAQyF,EAAUF,EAAErF,OAAS,GACzC8D,EAAUyB,EAAUF,EAAErF,SAE1B4D,KAAK,KAAMG,EAAaqC,KACxBxC,KAAK,OAAQ,4BACbA,KAAK,IAAK,SAAAyB,GAAC,OAAIa,EAAUb,EAAEnF,QAoB9B,SAASmG,EAAYC,GACnBA,EAAGC,aACAC,SAAS,GACTC,UAAU,YAAa,SAAepB,EAAGC,EAAG9D,GAC3C,OAAOmB,IAAA,cAAA8B,OACSZ,EADT,KAAAY,OACoBX,EADpB,eAAAW,OAEKC,EAASY,GAAK,IAFnB,KAAAb,OAE0BZ,EAF1B,KAAAY,OAEqCX,EAFrC,QAPbuC,EAfgB3C,EACbwB,UAAU,QACVzB,KAAKA,GACL0B,QACAxB,OAAO,QACPC,KAAK,IAAKG,EAAaqC,KACvBxC,KAAK,QAlKO,GAmKZA,KAAK,UAAW,GAChBA,KAAK,YAAa,SAAAyB,GAAC,OAAIA,EAAEvF,OACzB8D,KAAK,YAAa,SAAAyB,GAAC,OAAIA,EAAEjF,KAAKsG,aAC9B9C,KAAK,SAAU,SAAAyB,GAAC,OAAIE,EAAUF,EAAEvF,MAAQyF,EAAUF,EAAErF,QACpD4D,KAAK,OAAQ,SAAAyB,GAAC,OAAIY,GAAQZ,EAAEvF,KAAOuF,EAAErF,MAAQ,KAC7C4D,KAAK,SAAU,QACfA,KAAK,IAAK,SAAAyB,GAAC,OAAIvB,EAAUyB,EAAUF,EAAErF,SAGxCqG,EAAYF,aCjNCQ,mLATX,OACExD,EAAA3B,EAAA4B,cAAA,OAAKC,GAAG,QACNF,EAAA3B,EAAA4B,cAAA,oCACAD,EAAA3B,EAAA4B,cAACwD,EAAD,cALUrD,aCClBsD,IAASC,OAAO3D,EAAA3B,EAAA4B,cAAC2D,EAAD,MAASC,SAASC,eAAe","file":"static/js/main.19cf7aaa.chunk.js","sourcesContent":["import React from \"react\";\nimport * as d3 from \"d3\";\nimport dayjs from \"dayjs\";\n\ntype WeatherData = {\n  date: Date;\n  name: string;\n  prcp: number;\n  tavg: number;\n  tmax: number;\n  tmin: number;\n};\n\nconst ETLWeatherData = (wd: any): WeatherData => ({\n  name: wd.NAME,\n  tavg: +wd.TAVG,\n  tmax: +wd.TMAX,\n  tmin: +wd.TMIN,\n  prcp: +wd.PRCP,\n  date: dayjs(wd.DATE).toDate()\n});\n\nexport class Circle extends React.Component {\n  async componentDidMount() {\n    [\n      [\"San Francisco\", \"/sf_weather_2017.csv\"],\n      [\"Austin\", \"/austin_2017.csv\"],\n      [\"Los Angeles\", \"/los_angeles_2017.csv\"],\n      [\"Seattle\", \"/seattle_2017.csv\"],\n      [\"New York City\", \"/nyc_2017.csv\"],\n      [\"Cleveland\", \"/cleveland_2017.csv\"]\n    ].forEach(async ([label, csvFile]) =>\n      CircleRender(label, (await d3.csv(csvFile)).map(ETLWeatherData))\n    );\n  }\n  render() {\n    return <div id=\"weather-radials\" />;\n  }\n}\n\nfunction CircleRender(city: string, data: WeatherData[]) {\n  let svg = d3.select(\"#weather-radials\").append(\"svg\");\n\n  svg\n    .attr(\"viewBox\", \"0 0 1000 1000\")\n    .attr(\"width\", 700)\n    .attr(\"height\", 700);\n\n  let originX = 500;\n  let originY = 500;\n  let outerCircleRadius = 400;\n\n  let barWidth = 3;\n  let barOriginX = originX + outerCircleRadius * Math.sin(0);\n  let barOriginY = originY - outerCircleRadius * Math.cos(0);\n\n  const allTemps = data.reduce(\n    (p, n) => [...p, n.tmin, n.tmax],\n    [] as number[]\n  );\n\n  let extent = d3.extent(allTemps) as [number, number];\n\n  let dayScale = d3\n    .scaleLinear()\n    .domain([0, 365])\n    .range([0, 360]);\n\n  let tempScaleInvert = d3\n    .scaleLinear()\n    .domain([-40, 40])\n    .range([outerCircleRadius, 0]);\n\n  const monthScale = d3\n    .scaleLinear()\n    .domain([0, 12])\n    .range([0, 360]);\n\n  const MONTHS = [\n    \"JAN\",\n    \"FEB\",\n    \"MAR\",\n    \"APR\",\n    \"MAY\",\n    \"JUN\",\n    \"JUL\",\n    \"AUG\",\n    \"SEP\",\n    \"OCT\",\n    \"NOV\",\n    \"DEC\"\n  ];\n\n  svg\n    .append(\"text\")\n    .text(city.toUpperCase())\n    .attr(\"transform\", `translate(${originX},${originY})`)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", \"3.5rem\")\n    .attr(\"fill\", \"#6f6f6f\")\n    .attr(\"y\", \"0.75rem\");\n\n  const monthLabels = svg\n    .selectAll(\"g.month-label\")\n    .data(MONTHS)\n    .enter()\n    .append(\"g\")\n    .classed(\"month-label\", true);\n\n  monthLabels\n    .append(\"line\")\n    .attr(\"stroke\", \"black\")\n    .attr(\"x1\", 0)\n    .attr(\"x2\", 0)\n    .attr(\"y2\", 20);\n\n  monthLabels\n    .attr(\n      \"transform\",\n      (d, i) =>\n        `rotate(${monthScale(\n          i\n        )},${originX},${originY}) translate(${originX},${barOriginY - 35})`\n    )\n    .append(\"text\")\n    .attr(\"fill\", \"black\")\n    .attr(\"x\", 10)\n    .attr(\"y\", 10)\n    .text(function(d) {\n      return d.toUpperCase();\n    });\n\n  let tempScale = d3\n    .scaleLinear()\n    .domain([-40, 40])\n    .range([0, outerCircleRadius]);\n\n  let circles = svg\n    .selectAll(\".circle-ticks\")\n    .data(tempScale.ticks(7))\n    .enter()\n    .append(\"circle\")\n    .classed(\"circle-ticks\", true)\n    .attr(\"r\", function(d) {\n      return tempScale(d);\n    })\n    .style(\"fill\", \"none\")\n    .attr(\"cy\", originY)\n    .attr(\"cx\", originX)\n    .style(\"stroke\", \"black\")\n    .style(\"stroke-dasharray\", \"2,2\")\n    .style(\"stroke-width\", \".5px\");\n\n  svg.selectAll(\".circle-ticks:nth-of-type(2)\").remove();\n\n  let formatNumber = d3.format(\"-\");\n  let xAxis = d3\n    .axisLeft(tempScaleInvert)\n    .ticks(5)\n    .tickFormat(d => formatNumber(d) + \" Â°C\");\n\n  svg\n    .append(\"g\")\n    .attr(\"class\", \"x axis\")\n    .attr(\"transform\", `translate(${barOriginX},${barOriginY})`)\n    .call(xAxis as any);\n\n  svg.select(\".domain\").remove();\n  svg.selectAll(\".tick line\").remove();\n  svg\n    .selectAll(\".tick\")\n    .insert(\"rect\", \":first-child\")\n    .attr(\"width\", \"43\")\n    .attr(\"height\", \"10\")\n    .attr(\"fill\", \"#FFF\")\n    .attr(\"transform\", \"translate(-20,-5)\");\n\n  svg\n    .selectAll(\".tick text\")\n    .style(\"text-anchor\", \"middle\")\n    .attr(\"transform\", \"translate(10,0)\")\n    .style(\"padding-right\", 30);\n\n  svg.selectAll(\".tick:first-of-type\").remove();\n\n  //const invertExtent = extent.reverse();\n  const colors = d3.scaleSequential(d3.interpolateSpectral).domain([35, 5]);\n\n  const rainScale = d3\n    .scaleLinear()\n    .range([0, 100])\n    .domain([0, 100]);\n\n  const rainDrops = svg\n    .selectAll(\".rain\")\n    .data(data)\n    .enter()\n    .append(\"circle\")\n    .attr(\n      \"cy\",\n      d =>\n        (tempScale(d.tmax) - tempScale(d.tmin)) / 2 +\n        (originY + tempScale(d.tmin))\n    )\n    .attr(\"cx\", barOriginX - barWidth / 2)\n    .attr(\"fill\", \"rgba(120, 150, 251, 0.2)\")\n    .attr(\"r\", d => rainScale(d.prcp));\n\n  const tempBar = svg\n    .selectAll(\".bar\")\n    .data(data)\n    .enter()\n    .append(\"rect\")\n    .attr(\"x\", barOriginX - barWidth / 2)\n    .attr(\"width\", barWidth)\n    .attr(\"opacity\", 1)\n    .attr(\"data-temp\", d => d.tmax)\n    .attr(\"data-date\", d => d.date.toString())\n    .attr(\"height\", d => tempScale(d.tmax) - tempScale(d.tmin))\n    .attr(\"fill\", d => colors((d.tmax + d.tmin) / 2))\n    .attr(\"stroke\", \"none\")\n    .attr(\"y\", d => originY + tempScale(d.tmin));\n\n  rotateTween(tempBar);\n  rotateTween(rainDrops);\n\n  function rotateTween(el: d3.Selection<any, any, any, any>) {\n    el.transition()\n      .duration(0)\n      .attrTween(\"transform\", function tween(d, i, a) {\n        return d3.interpolateString(\n          `rotate(180,${originX},${originY})`,\n          `rotate(${dayScale(i) + 180},${originX},${originY})`\n        );\n      });\n  }\n}\n","import React, { Component } from \"react\";\nimport { Circle } from \"./WeatherRadial\";\nimport \"./App.css\";\n\nclass App extends Component {\n  render() {\n    return (\n      <div id=\"main\">\n        <h1>Weather Radials / 2017</h1>\n        <Circle />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}